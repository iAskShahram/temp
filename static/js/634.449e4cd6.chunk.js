"use strict";(self.webpackChunkthis=self.webpackChunkthis||[]).push([[634],{4634:function(e,t,n){n.r(t);var i=n(4165),a=n(2982),r=n(1413),s=n(5861),d=n(885),c=n(2791),u=n(2469),o=n(3360),l=n(3855),p=n(1134),m=n(7689),f=n(9085),h=n(8591),_=n(6536),g=n(2872),v=n(5142),x=n(7263),Z=n(6556),y=n(184);t.default=function(){var e=(0,m.TH)(),t=(0,m.s0)(),n=(0,c.useState)(!0),j=(0,d.Z)(n,2),b=j[0],N=j[1],C=(0,c.useState)(!1),S=(0,d.Z)(C,2),q=S[0],E=S[1],w=(0,c.useState)(0),Q=(0,d.Z)(w,2),D=Q[0],I=Q[1],F=(0,c.useState)([{age:"",education_level:""}]),k=(0,d.Z)(F,2),A=k[0],P=k[1],L=(0,c.useState)([]),O=(0,d.Z)(L,2),T=O[0],G=O[1],R=(0,_.a)("(min-width: 992px)"),z=(0,p.cI)(),H=z.register,B=z.handleSubmit,K=z.formState.errors,M=z.setValue,W=(0,h.t)(),Y=W.setEditPatientId_c,U=W.getEditNavigateTo_c,V=W.resetAllEdit_c,J=U();function X(){return(X=(0,s.Z)((0,i.Z)().mark((function n(){var a,r,s,d,c,u,o,l;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=null===(a=e.state)||void 0===a?void 0:a.id){n.next=4;break}return f.Am.error("No ID Found"),n.abrupt("return",t("/"));case 4:return E(!0),n.prev=5,n.next=8,(0,v.vZ)({id:r});case 8:if(200===(s=n.sent).status){for(I(parseInt(s.data.patient.demographic[0].children.no_of_children)),d=[],c=s.data.patient.demographic[0].children.children_age.split(","),u=s.data.patient.demographic[0].children.children_education_level.split(","),o=0;o<parseInt(s.data.patient.demographic[0].children.no_of_children);o++)d.push({age:parseInt(c[o]),education_level:u[o]});P(d),M("no_of_children",parseInt(s.data.patient.demographic[0].children.no_of_children)),M("children_age",parseInt(s.data.patient.demographic[0].children.children_age)),Z.R.forEach((function(e){"date"!==e.type?M(e.name,s.data.patient.demographic[0][e.name]):M(e.name,s.data.patient.demographic[0][e.name].split("T")[0])})),M("patient_id",parseInt(r)),M("demo_id",parseInt(s.data.patient.demographic[0].demo_section_answer[0].demo_id)),l=s.data.patient.demographic[0].demo_section_answer.map((function(e,t){return{id:e.question.id,answer_text:e.answer_text,question_text:e.question.question_text,is_nullable:e.question.is_nullable,question_urdu_text:e.question.question_urdu_text||"",radio_options:e.question.radio_options,is_radio_type:e.question.is_radio_type,is_date_type:e.question.is_date_type,is_number_type:e.question.is_number_type,is_text_type:e.question.is_text_type}})),G(l),l.forEach((function(e){M("".concat(e.id),e.answer_text)})),Y(r),E(!1)}else s.status>=400&&f.Am.error(s.message.message);n.next=15;break;case 12:n.prev=12,n.t0=n.catch(5),f.Am.error(n.t0.message);case 15:case"end":return n.stop()}}),n,null,[[5,12]])})))).apply(this,arguments)}function $(){return($=(0,s.Z)((0,i.Z)().mark((function e(n){var a,s,d,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=parseInt(n.patient_id))&&!isNaN(a)){e.next=4;break}return f.Am.error("Error processing the form, please try again later"),e.abrupt("return");case 4:if((0,g.E6)(A,D)){e.next=7;break}return f.Am.error("Please fill all the fields of children"),e.abrupt("return");case 7:if((s=parseInt(n.demo_id))&&!isNaN(s)){e.next=11;break}return f.Am.error("Error processing the form, please try again later"),e.abrupt("return");case 11:return E(!0),e.prev=12,d=(0,g.PM)({data:n,children:A,noOfChildren:D}),e.next=16,(0,v.YS)((0,r.Z)({demo_id:s,patient_id:a},d));case 16:200===(c=e.sent).status?(Y(a),t(J.caregiver)):c.status>=400&&f.Am.error("Some Error Occured!"),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(12),f.Am.error(e.t0.message);case 23:E(!1);case 24:case"end":return e.stop()}}),e,null,[[12,20]])})))).apply(this,arguments)}return(0,_.Z)("Edit Form"),(0,c.useEffect)((function(){var n,i;(window.scrollTo(0,0),V(),null!==(n=e.state)&&void 0!==n&&n.id)?(Y(null===(i=e.state)||void 0===i?void 0:i.id),function(){X.apply(this,arguments)}()):t("/")}),[]),(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(x.xc,{title:"Edit Patient Demographics",isLoading:q,children:[b?(0,y.jsxs)(u.Z,{variant:"info",dismissible:!0,onClose:function(){return N(!1)},children:[(0,y.jsx)(u.Z.Heading,{children:"Edit Patient Demographics"}),(0,y.jsx)("hr",{}),(0,y.jsx)("p",{className:"mb-0",children:"This is patient's data form. Please only fill patient's demographics here."})]}):null,(0,y.jsx)("div",{style:q?{pointerEvents:"none",opacity:.5}:{},children:(0,y.jsxs)(l.Z,{onSubmit:B((function(e){return $.apply(this,arguments)})),children:[Z.R.map((function(e,t){return(0,y.jsxs)(l.Z.Group,{className:"mb-3",controlId:e.name,children:[(0,y.jsxs)(l.Z.Label,{className:"row d-flex justify-content-between",children:[(0,y.jsx)("div",{className:"".concat(e.urdu_label.length>0?"col-md-6":"col-12"),children:(0,y.jsxs)("b",{children:["".concat(e.label," : "),e.required?(0,y.jsx)("span",{className:"text-danger",children:"*"}):null]})}),e.urdu_label.length>0?(0,y.jsx)("div",{className:"col-md-6 text-end",children:(0,y.jsxs)("b",{children:[e.required?(0,y.jsx)("span",{className:"text-danger",children:"*"}):null," : ".concat(e.urdu_label)]})}):null]}),(0,y.jsx)("div",{className:"px-10",children:"radio"===e.type?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(l.Z.Select,(0,r.Z)((0,r.Z)({id:"".concat(e.name,"-").concat(t)},H(e.name,{required:e.required})),{},{children:[(0,y.jsx)("option",{value:"",children:"Select"},0),e.radio_options.map((function(e,t){return(0,y.jsx)("option",{value:e,children:e},t+1)}))]}),t)}):(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.Z.Control,(0,r.Z)({type:e.type,min:0},H(e.name,{required:e.required})))})}),K[e.name]&&(0,y.jsx)("span",{className:"text-danger",children:"This field is required"})]},t)})),(0,y.jsxs)(l.Z.Group,{className:"mb-3",controlId:"no_of_children",children:[(0,y.jsx)(l.Z.Label,{children:(0,y.jsxs)("b",{children:["No of children : ",(0,y.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,y.jsx)("div",{className:"px-10",children:(0,y.jsx)(l.Z.Control,{type:"number",value:D,onChange:function(e){Number(e.target.value)>0?(I(Number(e.target.value)),P((0,a.Z)(Array(Number(e.target.value)).keys()).map((function(e){return{age:"",education_level:""}})))):f.Am.error("Number of children cannot be less than 1")},min:1,required:!0})})]}),D>0?A.map((function(e,t){return(0,y.jsxs)("div",{className:"row",children:[(0,y.jsx)("div",{className:"col-4",children:(0,y.jsxs)(l.Z.Group,{className:"mb-3",controlId:"age",children:[(0,y.jsx)(l.Z.Label,{children:(0,y.jsxs)("b",{children:["Age of child ".concat(t+1,": "),(0,y.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,y.jsx)("div",{className:"".concat(R?"px-10":"px-2"),children:(0,y.jsx)(l.Z.Control,{type:"text",onChange:function(e){var n=(0,a.Z)(A);n[t].age=e.target.value,P(n)},value:A[t].age})})]})}),(0,y.jsx)("div",{className:"col-8",children:(0,y.jsxs)(l.Z.Group,{className:"mb-3",controlId:"education_level",children:[(0,y.jsx)(l.Z.Label,{children:(0,y.jsxs)("b",{children:["Education level of child ".concat(t+1," : "),(0,y.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,y.jsx)("div",{className:"".concat(R?"px-10":"px-2"),children:(0,y.jsx)(l.Z.Control,{type:"text",onChange:function(e){var n=(0,a.Z)(A);n[t].education_level=e.target.value,P(n)},value:A[t].education_level})})]})})]},t)})):null,T.map((function(e,t){var n,i,a,s,d,c,u,o;return(0,y.jsxs)(l.Z.Group,{className:"mb-3",controlId:e.id,children:[(0,y.jsxs)(l.Z.Label,{className:"row d-flex justify-content-between",children:[(0,y.jsx)("div",{className:"".concat((null===(n=e.question_urdu_text)||void 0===n?void 0:n.length)>0?"col-md-6":"col-12"),children:(0,y.jsxs)("b",{children:["".concat(e.question_text," : "),e.is_nullable?null:(0,y.jsx)("span",{className:"text-danger",children:"*"})]})}),(null===(i=e.question_urdu_text)||void 0===i?void 0:i.length)>0?(0,y.jsx)("div",{className:"col-md-6 text-end",children:(0,y.jsxs)("b",{children:[e.is_nullable?null:(0,y.jsx)("span",{className:"text-danger",children:"*"})," : ".concat(e.question_urdu_text)]})}):null]}),(0,y.jsx)("div",{className:"px-10",children:e.is_text_type?(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.Z.Control,(0,r.Z)({type:"text"},H(null===(a=e.id)||void 0===a?void 0:a.toString(),{required:!e.is_nullable})))}):e.is_number_type?(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.Z.Control,(0,r.Z)({type:"number",min:0},H(null===(s=e.id)||void 0===s?void 0:s.toString(),{required:!e.is_nullable})))}):e.is_date_type?(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.Z.Control,(0,r.Z)({type:"date"},H(null===(d=e.id)||void 0===d?void 0:d.toString(),{required:!e.is_nullable})))}):e.is_radio_type?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(l.Z.Select,(0,r.Z)((0,r.Z)({id:"".concat(e.id,"-").concat(t)},H(null===(c=e.id)||void 0===c?void 0:c.toString(),{required:!e.is_nullable})),{},{children:[(0,y.jsx)("option",{value:"",children:"Select"},"0"),null===(u=e.radio_options)||void 0===u?void 0:u.split(",").map((function(t,n){return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("option",{value:t,children:t},"default-".concat(e.id,"-").concat(n))})}))]}))}):null}),K[null===(o=e.id)||void 0===o?void 0:o.toString()]?(0,y.jsx)("span",{className:"text-danger",children:"This field is required"}):null]},t)})),(0,y.jsx)(l.Z.Group,{className:"mb-3",children:(0,y.jsx)(o.Z,{className:"mb-3 float-end",variant:"primary",type:"submit",children:"Next"})})]})})]})})}},6556:function(e,t,n){n.d(t,{R:function(){return i}});var i=[{label:"Name",urdu_label:"\u0646\u0627\u0645",type:"text",name:"name",required:!1},{label:"Gender",urdu_label:"\u0635\u0646\u0641",type:"radio",name:"gender",required:!0,radio_options:["male","female"]},{label:"Age",urdu_label:"\u0639\u0645\u0631",type:"number",name:"age",required:!0},{label:"Date of Birth",urdu_label:"\u0639\u0645\u0631",type:"date",name:"dob",required:!0}]},7263:function(e,t,n){n.d(t,{Uy:function(){return c},xc:function(){return d}});var i=n(4849),a=n(3360),r=n(7689),s=n(184),d=function(e){var t=e.children,n=e.title,d=e.isLoading,c=e.paddingSmall,u=e.resetCookieAndLocalStorage,o=(0,r.s0)();return(0,s.jsxs)("div",{className:"my-8 card ",children:[(0,s.jsxs)("h1",{className:"card-header",children:[(0,s.jsx)("div",{className:"card-title m-0",children:(0,s.jsx)("h3",{className:"fw-bolder m-0",children:n})}),d?(0,s.jsxs)("div",{className:"card-subtitle card-title m-0",children:[(0,s.jsx)(i.Z,{as:"span",animation:"grow",size:"md",role:"status","aria-hidden":"true"}),(0,s.jsx)("p",{className:"m-0",children:"Loading ..."})]}):null,u&&(0,s.jsx)("div",{className:"card-subtitle card-title m-0",children:(0,s.jsx)(a.Z,{variant:"outline-danger",className:"m-0",onClick:function(){window.confirm("Are you sure you want to clear cache?")&&(u(),o("/"))},children:"Clear Form Cache"})})]}),(0,s.jsx)("div",{className:"card-body ".concat(d?"opacity-50":null),style:d?{pointerEvents:"none"}:{},children:(0,s.jsx)("div",{className:"".concat(c?"p-sm-0 px-md-3 px-lg-10":"p-sm-0 px-md-10 px-lg-20"),children:t})})]})},c=function(e){var t=e.children,n=e.styles;return(0,s.jsx)("div",{className:"d-flex align-items-center justify-content-center",style:n,children:(0,s.jsx)("div",{className:"text-center",children:t})})}},2872:function(e,t,n){n.d(t,{E6:function(){return s},PM:function(){return d},Wb:function(){return o},ZI:function(){return u},z_:function(){return c}});var i=n(1413),a=n(885),r=n(6556),s=function(e,t){if(0===t)return!0;if(!e)return!1;if(!Array.isArray(e)||e.length!==t)return!1;for(var n=!0,i=0;i<e.length;i++){var a=e[i];if(0===a.age.length||0===a.education_level.length){n=!1;break}}return n},d=function(e){return l({data:e.data,children:e.children,noOfChildren:e.noOfChildren,patient_id:null})},c=function(e){return l({data:e.data,children:e.children,noOfChildren:e.noOfChildren,patient_id:e.patient_id})},u=function(e){var t=e.data,n=e.patient_id,i=r.R.map((function(e){return e.name})).reduce((function(e,n){return e[n]=t[n],e}),{});return{dynamicQuestions:{dynamicKeys:Object.keys(t).map((function(e){return Number(e)})),dynamicData:t},preDefinedQuestions:i,patient_id:n}},o=function(e){for(var t=e.patient_id,n=e.data,i=[],r=0,s=Object.entries(n);r<s.length;r++){var d=(0,a.Z)(s[r],2),c=d[0],u=d[1];if(u){var o=null===c||void 0===c?void 0:c.split("-"),l=(0,a.Z)(o,3),p=l[0],m=l[1],f=l[2],h=null===u||void 0===u?void 0:u.split("-"),_=(0,a.Z)(h,3),g=_[0],v=_[1],x=_[2];i.push({patient_id:parseInt(p),section_id:parseInt(m),section_question_id:parseInt(f),section_option_id:parseInt(g),answer_text:x,is_answer_in_urdu:Boolean(Number(v))})}}return{patient_id:t,data:i}};function l(e){var t=e.data,n=e.children,a=e.noOfChildren,s=e.patient_id,d=r.R.map((function(e){return e.name})).reduce((function(e,n){return e[n]=t[n],e}),{});d.no_of_children=a,n.forEach((function(e){var t,n;d.children_age=d.children_age?d.children_age+","+e.age.toString():e.age.toString(),d.children_education_level=d.children_education_level?d.children_education_level+","+(null===(t=e.education_level)||void 0===t?void 0:t.replace(","," ").toString()):null===(n=e.education_level)||void 0===n?void 0:n.replace(","," ").toString()}));var c={dynamicQuestions:{dynamicKeys:Object.keys(t).map((function(e){return Number(e)})),dynamicData:t},preDefinedQuestions:d};return s?(0,i.Z)((0,i.Z)({},c),{},{patient_id:s}):c}},5142:function(e,t,n){n.d(t,{dI:function(){return N},s4:function(){return f},xi:function(){return _},QI:function(){return Z},yw:function(){return j},c3:function(){return v},sT:function(){return l},vZ:function(){return p},Wl:function(){return h},zS:function(){return y},LO:function(){return g},o9:function(){return b},YS:function(){return m},HR:function(){return x}});var i=n(4165),a=n(5861),r=n(3144),s=n(5671),d=n(7976),c=(0,r.Z)((function e(){(0,s.Z)(this,e)}));c.getLatestFilledForms=function(e){var t=e._pageNo,n=e._count,i="/api/form/list-latest-filled-forms?_pageNo=".concat(t,"&_count=").concat(n);return d.Z.get(i)},c.getPatientEditForm=function(e){var t=e.id,n="/api/form/get-edit-demo?id=".concat(t,"&type=patient");return d.Z.get(n)},c.updatePatientDemo=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return d.Z.post("/api/form/update-edit-demo",{dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a,type:"patient"})},c.getCaregiverEditForm=function(e){var t=e.id,n="/api/form/get-edit-demo?id=".concat(t,"&type=caregiver");return d.Z.get(n)},c.updateCaregiverDemo=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return d.Z.post("/api/form/update-edit-demo",{dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a,type:"caregiver"})},c.getChildEditForm=function(e){var t=e.id,n="/api/form/get-edit-demo?id=".concat(t,"&type=child");return d.Z.get(n)},c.updateChildDemo=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return d.Z.post("/api/form/update-edit-demo",{dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a,type:"child"})},c.getEditPatientScales=function(e){var t=e.id,n="/api/form/get-edit-scale?id=".concat(t,"&type=patient");return d.Z.get(n)},c.updatePatientScales=function(e){var t=e.patient_id,n=e.scales;return d.Z.post("/api/form/update-edit-scale",{patient_id:t,scales:n,type:"patient"})},c.getEditCaregiverScales=function(e){var t=e.id,n="/api/form/get-edit-scale?id=".concat(t,"&type=caregiver");return d.Z.get(n)},c.updateCaregiverScales=function(e){var t=e.patient_id,n=e.scales;return d.Z.post("/api/form/update-edit-scale",{patient_id:t,scales:n,type:"caregiver"})},c.getEditChildScales=function(e){var t=e.id,n="/api/form/get-edit-scale?id=".concat(t,"&type=child");return d.Z.get(n)},c.updateChildScales=function(e){var t=e.patient_id,n=e.scales;return d.Z.post("/api/form/update-edit-scale",{patient_id:t,scales:n,type:"child"})},c.deleteForm=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a="/api/form/delete-form?id=".concat(n),e.abrupt("return",d.Z.delete(a));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var u=c,o=n(3984),l=function(e){return u.getLatestFilledForms(e).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},p=function(e){return u.getPatientEditForm(e).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},m=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return u.updatePatientDemo({dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},f=function(e){return u.getCaregiverEditForm(e).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},h=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return u.updateCaregiverDemo({dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},_=function(e){return u.getChildEditForm(e).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},g=function(e){var t=e.dynamicQuestions,n=e.preDefinedQuestions,i=e.demo_id,a=e.patient_id;return u.updateChildDemo({dynamicQuestions:t,preDefinedQuestions:n,demo_id:i,patient_id:a}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},v=function(e){var t=e.id;return u.getEditPatientScales({id:t}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},x=function(e){var t=e.patient_id,n=e.scales;return u.updatePatientScales({patient_id:t,scales:n}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},Z=function(e){var t=e.id;return u.getEditCaregiverScales({id:t}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return console.log(e),(0,o.Z)(e)}))},y=function(e){var t=e.patient_id,n=e.scales;return u.updateCaregiverScales({patient_id:t,scales:n}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},j=function(e){var t=e.id;return u.getEditChildScales({id:t}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},b=function(e){var t=e.patient_id,n=e.scales;return u.updateChildScales({patient_id:t,scales:n}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))},N=function(e){var t=e.id;return u.deleteForm({id:t}).then((function(e){return{status:e.status,data:e.data,message:"success"}})).catch((function(e){return(0,o.Z)(e)}))}}}]);
//# sourceMappingURL=634.449e4cd6.chunk.js.map